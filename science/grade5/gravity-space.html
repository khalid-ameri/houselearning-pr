<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Gravity & Space üåå</title>
<style>
:root{
  --bg:#f7fbff; --panel:#fff; --accent:#34495e; --accent2:#2c3e50; --ok:#16a34a; --bad:#ef4444; --muted:#566270;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter, "Segoe UI", Arial, sans-serif;background:var(--bg);color:#04263b;}
header{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;padding:22px 12px;text-align:center}
header h1{margin:0;font-size:clamp(20px,3vw,30px)}
main{max-width:1100px;margin:20px auto;padding:14px}
section{background:var(--panel);border-radius:12px;padding:16px;margin:14px 0;box-shadow:0 8px 24px rgba(2,6,23,0.06)}
h2{color:var(--accent2);margin:0 0 10px 0}
p{margin:8px 0}
.controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
button{background:var(--accent2);color:#fff;border:none;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:700}
button.secondary{background:#60a5fa;color:#fff}
button.ghost{background:#dbeafe;color:var(--accent2);border:1px solid #93c5fd}
button.warn{background:#f97316}
input[type=number], input[type=text], select{padding:8px;border-radius:8px;border:1px solid #93c5fd;font-size:1rem}
.grid{display:grid;gap:10px}
.grid.cols-4{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
.tile{background:#fff;padding:12px;border-radius:8px;text-align:center;border:1px solid var(--accent);cursor:pointer;font-weight:700}
.status{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.pill{background:#e6ffef;color:var(--ok);padding:6px 10px;border-radius:999px;font-weight:800}
.muted{color:var(--muted)}
footer{text-align:center;padding:12px;margin-top:8px;color:#334155}
.answer{font-weight:800;margin-top:8px}
.ok{color:var(--ok)}
.bad{color:var(--bad)}
canvas{background:#fff;border:1px solid var(--accent);border-radius:8px;display:block;margin-top:10px;width:100%;}
.tile.selected {
  border: 2px solid var(--accent2);
  box-shadow: 0 0 8px rgba(44, 62, 80, 0.5);
}
.quiz-canvas {
  width: 100%;
  height: 150px;
  border-radius: 8px;
  margin-bottom: 8px;
  background-color: #f7f9fb;
}
</style>
</head>
<body>
<header>
<h1>Gravity & Space üåå</h1>
<p style="margin:6px 0 0 0;opacity:.95">Interactive Lesson ‚Ä¢ Practice ‚Ä¢ Sorting Game</p>
</header>
<main>
<section aria-labelledby="introTitle">
<h2 id="introTitle">What is Gravity? ü§î</h2>
<p>
  **Gravity** is a force that pulls things toward each other. The more mass something has, the stronger its gravity is. You can't see gravity, but you can see its effects everywhere! It's what keeps you on the ground and not floating away into space.
</p>
<p>
  In space, gravity is what keeps planets in orbit around the Sun and keeps moons in orbit around planets. Without gravity, everything would just fly apart!
</p>
<div class="status" style="margin-top:8px">
  <div class="pill" id="score">Score: 0</div>
  <div class="muted" id="streak">Streak: 0</div>
</div>
</section>

<section aria-labelledby="videoTitle">
<h2 id="videoTitle">Video: The Gravity Well üé¨</h2>
<p>Watch how gravity is like a pull that big objects have on smaller objects.</p>
<div class="canvas-wrapper">
  <canvas id="tutorialCanvas" width="800" height="400"></canvas>
</div>
<div class="controls">
  <button id="playTutorial" class="secondary">‚ñ∂Ô∏è Play Video</button>
</div>
<div class="settings">
  <label>Speed: <input type="number" id="videoSpeed" value="1" min="0.5" max="2" step="0.1"></label>
</div>
</section>

<section aria-labelledby="practiceTitle">
<h2 id="practiceTitle">Practice Problems (What is Gravity affecting?)</h2>
<p>Read the description and click if gravity is the main force at work.</p>
<div class="grid cols-4" style="margin-top:10px">
  <div class="tile" id="q1-tile">
    <div style="font-weight:700">1) A ball falling to the ground.</div>
    <div class="controls" style="margin-top:6px">
      <button onclick="checkAnswer('q1', 'gravity', this)">Gravity</button>
      <button onclick="checkAnswer('q1', 'not gravity', this)">Not Gravity</button>
    </div>
    <div id="r1" class="answer"></div>
  </div>
  <div class="tile" id="q2-tile">
    <div style="font-weight:700">2) Two magnets sticking together.</div>
    <div class="controls" style="margin-top:6px">
      <button onclick="checkAnswer('q2', 'gravity', this)">Gravity</button>
      <button onclick="checkAnswer('q2', 'not gravity', this)">Not Gravity</button>
    </div>
    <div id="r2" class="answer"></div>
  </div>
  <div class="tile" id="q3-tile">
    <div style="font-weight:700">3) The Moon circling the Earth.</div>
    <div class="controls" style="margin-top:6px">
      <button onclick="checkAnswer('q3', 'gravity', this)">Gravity</button>
      <button onclick="checkAnswer('q3', 'not gravity', this)">Not Gravity</button>
    </div>
    <div id="r3" class="answer"></div>
  </div>
  <div class="tile" id="q4-tile">
    <div style="font-weight:700">4) A rocket launching into space.</div>
    <div class="controls" style="margin-top:6px">
      <button onclick="checkAnswer('q4', 'gravity', this)">Gravity</button>
      <button onclick="checkAnswer('q4', 'not gravity', this)">Not Gravity</button>
    </div>
    <div id="r4" class="answer"></div>
  </div>
</div>
</section>

<section aria-labelledby="speedTitle">
<h2 id="speedTitle">‚ö° Find the Objects!</h2>
<p>Click on the object that has more gravity!</p>
<div class="controls">
  <div class="muted" id="quizTimer">Time: 0</div>
  <div id="quizScore" class="pill">Correct: 0</div>
</div>
<div style="margin-top:12px">
  <div style="font-size:1.6rem;font-weight:800" id="quizQ">Press Start!</div>
  <div style="margin-top:8px" class="controls">
    <button id="findMoreGravity" class="secondary" onclick="newQuiz()">Find More Gravity</button>
  </div>
  <div id="quizFeedback" class="answer"></div>
</div>
<div class="grid cols-4" style="margin-top:10px" id="quiz-grid">
</div>
</section>

<section aria-labelledby="resetTitle">
<h2 id="resetTitle">Reset Your Score</h2>
<p>If you want to play again, you can reset your score here.</p>
<button id="resetScoreBtn" class="warn" onclick="reset()">Reset Score</button>
</section>

<footer>Gravity makes the universe a fun place!</footer>
</main>
<script>
/* ===== Utilities ===== */
const tone = (f = 880, d = 0.06) => {
  try {
    const A = new (window.AudioContext || window.webkitAudioContext)();
    const o = A.createOscillator();
    const g = A.createGain();
    o.type = 'sine';
    o.frequency.value = f;
    g.gain.value = 0.0001;
    o.connect(g);
    g.connect(A.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.12, A.currentTime + 0.01);
    g.gain.exponentialRampToValueAtTime(0.0001, A.currentTime + d);
    setTimeout(() => { o.stop(); A.close().catch(() => {}); }, d * 1000 + 50);
  } catch (e) {}
};
let totalScore = 0, streak = 0;
function updateScore(points) {
  if (points > 0) {
    totalScore += points;
    streak++;
  } else {
    streak = 0;
  }
  document.getElementById('score').textContent = `Score: ${totalScore}`;
  document.getElementById('streak').textContent = `Streak: ${streak}`;
}
window.checkAnswer = (questionId, selectedAnswer, button) => {
  const correctAnswers = {
    'q1': 'gravity', 'q2': 'not gravity', 'q3': 'gravity', 'q4': 'not gravity'
  };
  const resultId = 'r' + questionId.slice(1);
  const res = document.getElementById(resultId);
  
  const buttons = document.querySelectorAll(`#${questionId}-tile button`);
  buttons.forEach(btn => btn.disabled = true);

  if (selectedAnswer === correctAnswers[questionId]) {
    res.textContent = '‚úÖ Correct!';
    res.className = 'answer ok';
    tone(880, 0.06);
    updateScore(1);
  } else {
    res.textContent = `‚ùå Wrong`;
    res.className = 'answer bad';
    tone(220, 0.06);
    updateScore(0);
  }
};

/* ===== Canvas Tutorial ===== */
const tutorialCanvas = document.getElementById('tutorialCanvas');
const ctx = tutorialCanvas.getContext('2d');
const tutorialSpeedInput = document.getElementById('videoSpeed');
const voice = window.speechSynthesis.getVoices().find(v => v.name.includes('female') || v.name.includes('F'));

function drawText(canvasCtx, text, x, y, color = '#f7f9fb', size = '20px') {
  canvasCtx.textAlign = 'center';
  canvasCtx.font = `${size} Inter, sans-serif`;
  canvasCtx.fillStyle = color;
  canvasCtx.fillText(text, x, y);
}

function drawScene(canvasCtx, stage) {
  canvasCtx.clearRect(0, 0, canvasCtx.canvas.width, canvasCtx.canvas.height);
  const w = canvasCtx.canvas.width;
  const h = canvasCtx.canvas.height;
  canvasCtx.fillStyle = '#1c223c';
  canvasCtx.fillRect(0, 0, w, h);

  // Draw Sun
  canvasCtx.fillStyle = '#f1c40f';
  canvasCtx.beginPath();
  canvasCtx.arc(w/2, h/2, 60, 0, Math.PI * 2);
  canvasCtx.fill();

  // Draw Earth
  canvasCtx.fillStyle = '#3498db';
  canvasCtx.beginPath();
  canvasCtx.arc(w/2 + 200, h/2, 20, 0, Math.PI * 2);
  canvasCtx.fill();
  
  // Draw Moon
  canvasCtx.fillStyle = '#95a5a6';
  canvasCtx.beginPath();
  canvasCtx.arc(w/2 + 250, h/2, 10, 0, Math.PI * 2);
  canvasCtx.fill();
  
  if (stage === 'sun-earth') {
    canvasCtx.strokeStyle = '#f1c40f';
    canvasCtx.lineWidth = 4;
    canvasCtx.beginPath();
    canvasCtx.moveTo(w/2, h/2);
    canvasCtx.lineTo(w/2 + 200, h/2);
    canvasCtx.stroke();
    drawText(canvasCtx, "The Sun's gravity pulls on Earth.", w/2 + 100, h/2 - 50);
  } else if (stage === 'earth-moon') {
    canvasCtx.strokeStyle = '#3498db';
    canvasCtx.lineWidth = 4;
    canvasCtx.beginPath();
    canvasCtx.moveTo(w/2 + 200, h/2);
    canvasCtx.lineTo(w/2 + 250, h/2);
    canvasCtx.stroke();
    drawText(canvasCtx, "Earth's gravity pulls on the Moon.", w/2 + 225, h/2 - 20);
  } else {
    drawText(canvasCtx, "Press Play to see how gravity works!", w/2, h/2 - 100, '#fff');
  }
}

const tutorialSteps = [
  { audio: "Gravity is a force that pulls objects toward each other.", viz: 'initial' },
  { audio: "The more mass an object has, the more gravity it has. The big sun has a lot of gravity.", viz: 'sun-earth' },
  { audio: "The sun's gravity keeps the Earth in its orbit. Earth's gravity keeps the Moon in its orbit.", viz: 'earth-moon' },
  { audio: "So gravity keeps everything in space from flying apart!", viz: 'initial' },
];
let tutorialIndex = 0;
async function playTutorialVideo() {
  if (speechSynthesis.speaking) return;
  tutorialIndex = 0;
  const speed = parseFloat(tutorialSpeedInput.value) || 1;
  function nextStep() {
    if (tutorialIndex >= tutorialSteps.length) {
      drawScene(ctx, 'initial');
      return;
    }
    const step = tutorialSteps[tutorialIndex];
    const utterance = new SpeechSynthesisUtterance(step.audio);
    utterance.rate = speed;
    utterance.pitch = 1.2;
    utterance.volume = 1;
    if (voice) utterance.voice = voice;
    utterance.onend = () => {
      tutorialIndex++;
      nextStep();
    };
    drawScene(ctx, step.viz);
    speechSynthesis.speak(utterance);
  }
  nextStep();
}
document.getElementById('playTutorial').addEventListener('click', () => playTutorialVideo());
drawScene(ctx, 'initial');

/* ===== Quiz ===== */
const quizItems = [
  { text: 'A feather', emoji: 'ü™∂', isGreater: false },
  { text: 'A bowling ball', emoji: 'üé≥', isGreater: true },
  { text: 'The Sun', emoji: '‚òÄÔ∏è', isGreater: true },
  { text: 'The Earth', emoji: 'üåé', isGreater: false },
  { text: 'A car', emoji: 'üöó', isGreater: false },
  { text: 'A truck', emoji: 'üöö', isGreater: true },
];

let currentQuizType = null;
let quizScore = 0;
const quizGrid = document.getElementById('quiz-grid');
const quizFeedback = document.getElementById('quizFeedback');
const quizQuestion = document.getElementById('quizQ');

function newQuiz() {
  const selectedItems = [...quizItems].filter(item => item.isGreater).slice(0, 1).concat([...quizItems].filter(item => !item.isGreater).slice(0, 1));
  const shuffledItems = selectedItems.sort(() => 0.5 - Math.random());
  
  quizGrid.innerHTML = '';
  shuffledItems.forEach((item, index) => {
    const tile = document.createElement('div');
    tile.className = 'tile';
    tile.id = `item-${index}`;
    tile.onclick = () => selectQuizItem(item.isGreater, tile);
    
    const emoji = document.createElement('div');
    emoji.style.fontSize = '40px';
    emoji.textContent = item.emoji;
    
    const text = document.createElement('div');
    text.style.fontWeight = '700';
    text.textContent = item.text;

    tile.appendChild(emoji);
    tile.appendChild(text);
    quizGrid.appendChild(tile);
  });
  
  quizQuestion.textContent = `Click on the object with more gravity!`;
  quizFeedback.textContent = '';
  quizScore = 0;
  document.getElementById('quizScore').textContent = `Correct: ${quizScore}`;
}
window.selectQuizItem = (isGreater, tile) => {
  if (isGreater) {
    quizFeedback.textContent = `‚úÖ Correct! The object with more mass has more gravity!`;
    quizFeedback.className = 'answer ok';
    quizScore++;
    document.getElementById('quizScore').textContent = `Correct: ${quizScore}`;
    tone(880, 0.06);
    tile.classList.add('selected');
    setTimeout(() => newQuiz(), 1000);
  } else {
    quizFeedback.textContent = `‚ùå Wrong. Try again!`;
    quizFeedback.className = 'answer bad';
    tone(220, 0.06);
  }
};

window.newQuiz = () => {
    newQuiz();
};

// Initial setup
newQuiz();

// Reset Score Button
window.reset = () => {
  totalScore = 0;
  streak = 0;
  document.getElementById('score').textContent = `Score: 0`;
  document.getElementById('streak').textContent = `Streak: 0`;
  quizScore = 0;
  document.getElementById('quizScore').textContent = `Correct: 0`;
  quizFeedback.textContent = '';
  const tiles = document.querySelectorAll('#quiz-grid .tile');
  tiles.forEach(tile => tile.classList.remove('selected'));
  newQuiz();
};
</script>
</body>
</html>
